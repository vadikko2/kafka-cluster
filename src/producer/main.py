import asyncio
import logging
import typing

from producer import producer_application, settings

logging.basicConfig(level="DEBUG")

logger = logging.getLogger("kafka-producer")

logging.getLogger("aiokafka").setLevel("ERROR")
logging.getLogger("asyncio").setLevel("ERROR")

RPS = 1000


def message_factory() -> typing.Iterable[typing.Tuple[bytes, bytes]]:
    counter = 0
    while True:
        for _ in range(RPS):
            yield f"excounter_test|test1|squats|{counter}".encode(
                "utf-8",
            ), b"""{
                "user_id": "test1",
                "ex_id": "squats",
                "size": [
                    256,
                    256
                ],
                "label": "squats",
                "with_clf": true,
                "points": [
                    [
                        [
                            [
                                [
                                    0.156552,
                                    0.433529,
                                    0.264934
                                ],
                                [
                                    0.128453,
                                    0.417472,
                                    0.626208
                                ],
                                [
                                    0.132467,
                                    0.461628,
                                    0.734591
                                ],
                                [
                                    0.132467,
                                    0.397402,
                                    0.264934
                                ],
                                [
                                    0.152538,
                                    0.489727,
                                    0.734591
                                ],
                                [
                                    0.264934,
                                    0.393387,
                                    0.373317
                                ],
                                [
                                    0.236835,
                                    0.517826,
                                    0.883114
                                ],
                                [
                                    0.441557,
                                    0.369302,
                                    0.734591
                                ],
                                [
                                    0.421486,
                                    0.457614,
                                    0.734591
                                ],
                                [
                                    0.341203,
                                    0.317118,
                                    0.264934
                                ],
                                [
                                    0.297048,
                                    0.337189,
                                    0.818888
                                ],
                                [
                                    0.541911,
                                    0.485713,
                                    0.818888
                                ],
                                [
                                    0.537897,
                                    0.565996,
                                    0.734591
                                ],
                                [
                                    0.730577,
                                    0.409444,
                                    0.92727
                                ],
                                [
                                    0.754661,
                                    0.465642,
                                    0.818888
                                ],
                                [
                                    0.959383,
                                    0.469656,
                                    0.373317
                                ],
                                [
                                    0.979454,
                                    0.525855,
                                    0.264934
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.19268,
                                    0.425501,
                                    0.734591
                                ],
                                [
                                    0.152538,
                                    0.409444,
                                    0.734591
                                ],
                                [
                                    0.160566,
                                    0.4536,
                                    0.50177
                                ],
                                [
                                    0.156552,
                                    0.393387,
                                    0.180637
                                ],
                                [
                                    0.184651,
                                    0.477685,
                                    0.626208
                                ],
                                [
                                    0.297048,
                                    0.385359,
                                    0.626208
                                ],
                                [
                                    0.252892,
                                    0.50177,
                                    0.818888
                                ],
                                [
                                    0.457614,
                                    0.369302,
                                    0.626208
                                ],
                                [
                                    0.461628,
                                    0.457614,
                                    0.818888
                                ],
                                [
                                    0.365288,
                                    0.321133,
                                    0.818888
                                ],
                                [
                                    0.341203,
                                    0.337189,
                                    0.818888
                                ],
                                [
                                    0.553954,
                                    0.493741,
                                    0.264934
                                ],
                                [
                                    0.541911,
                                    0.574024,
                                    0.734591
                                ],
                                [
                                    0.730577,
                                    0.401416,
                                    0.626208
                                ],
                                [
                                    0.758676,
                                    0.465642,
                                    0.883114
                                ],
                                [
                                    0.959383,
                                    0.481699,
                                    0.50177
                                ],
                                [
                                    0.983468,
                                    0.517826,
                                    0.734591
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.220779,
                                    0.409444,
                                    0.626208
                                ],
                                [
                                    0.196694,
                                    0.393387,
                                    0.734591
                                ],
                                [
                                    0.188665,
                                    0.441557,
                                    0.818888
                                ],
                                [
                                    0.196694,
                                    0.381345,
                                    0.373317
                                ],
                                [
                                    0.208736,
                                    0.477685,
                                    0.626208
                                ],
                                [
                                    0.317118,
                                    0.381345,
                                    0.734591
                                ],
                                [
                                    0.280991,
                                    0.497755,
                                    0.818888
                                ],
                                [
                                    0.481699,
                                    0.365288,
                                    0.626208
                                ],
                                [
                                    0.481699,
                                    0.437543,
                                    0.734591
                                ],
                                [
                                    0.389373,
                                    0.317118,
                                    0.818888
                                ],
                                [
                                    0.373317,
                                    0.329161,
                                    0.50177
                                ],
                                [
                                    0.578039,
                                    0.505784,
                                    0.264934
                                ],
                                [
                                    0.553954,
                                    0.594095,
                                    0.818888
                                ],
                                [
                                    0.746633,
                                    0.393387,
                                    0.734591
                                ],
                                [
                                    0.754661,
                                    0.457614,
                                    0.818888
                                ],
                                [
                                    0.979454,
                                    0.481699,
                                    0.883114
                                ],
                                [
                                    0.979454,
                                    0.513812,
                                    0.734591
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.26092,
                                    0.401416,
                                    0.50177
                                ],
                                [
                                    0.240849,
                                    0.381345,
                                    0.373317
                                ],
                                [
                                    0.240849,
                                    0.425501,
                                    0.626208
                                ],
                                [
                                    0.252892,
                                    0.373317,
                                    0.50177
                                ],
                                [
                                    0.252892,
                                    0.461628,
                                    0.883114
                                ],
                                [
                                    0.369302,
                                    0.377331,
                                    0.626208
                                ],
                                [
                                    0.329161,
                                    0.47367,
                                    0.818888
                                ],
                                [
                                    0.533883,
                                    0.377331,
                                    0.264934
                                ],
                                [
                                    0.537897,
                                    0.425501,
                                    0.626208
                                ],
                                [
                                    0.437543,
                                    0.305076,
                                    0.626208
                                ],
                                [
                                    0.429515,
                                    0.321133,
                                    0.818888
                                ],
                                [
                                    0.586067,
                                    0.529869,
                                    0.50177
                                ],
                                [
                                    0.57001,
                                    0.598109,
                                    0.734591
                                ],
                                [
                                    0.742619,
                                    0.389373,
                                    0.883114
                                ],
                                [
                                    0.766704,
                                    0.4536,
                                    0.818888
                                ],
                                [
                                    0.923256,
                                    0.461628,
                                    0.180637
                                ],
                                [
                                    0.979454,
                                    0.50177,
                                    0.264934
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.297048,
                                    0.393387,
                                    0.626208
                                ],
                                [
                                    0.268948,
                                    0.377331,
                                    0.626208
                                ],
                                [
                                    0.272963,
                                    0.421486,
                                    0.626208
                                ],
                                [
                                    0.276977,
                                    0.369302,
                                    0.180637
                                ],
                                [
                                    0.276977,
                                    0.4536,
                                    0.626208
                                ],
                                [
                                    0.409444,
                                    0.381345,
                                    0.373317
                                ],
                                [
                                    0.35726,
                                    0.477685,
                                    0.734591
                                ],
                                [
                                    0.557968,
                                    0.381345,
                                    0.264934
                                ],
                                [
                                    0.565996,
                                    0.429515,
                                    0.264934
                                ],
                                [
                                    0.465642,
                                    0.305076,
                                    0.734591
                                ],
                                [
                                    0.449586,
                                    0.317118,
                                    0.734591
                                ],
                                [
                                    0.598109,
                                    0.513812,
                                    0.50177
                                ],
                                [
                                    0.590081,
                                    0.590081,
                                    0.734591
                                ],
                                [
                                    0.738605,
                                    0.377331,
                                    0.818888
                                ],
                                [
                                    0.766704,
                                    0.461628,
                                    0.626208
                                ],
                                [
                                    0.979454,
                                    0.485713,
                                    0.883114
                                ],
                                [
                                    0.979454,
                                    0.505784,
                                    0.818888
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.325147,
                                    0.381345,
                                    0.626208
                                ],
                                [
                                    0.30909,
                                    0.369302,
                                    0.180637
                                ],
                                [
                                    0.301062,
                                    0.413458,
                                    0.626208
                                ],
                                [
                                    0.313104,
                                    0.377331,
                                    0.373317
                                ],
                                [
                                    0.313104,
                                    0.449586,
                                    0.626208
                                ],
                                [
                                    0.421486,
                                    0.389373,
                                    0.50177
                                ],
                                [
                                    0.381345,
                                    0.461628,
                                    0.626208
                                ],
                                [
                                    0.606138,
                                    0.389373,
                                    0.373317
                                ],
                                [
                                    0.606138,
                                    0.425501,
                                    0.373317
                                ],
                                [
                                    0.509798,
                                    0.317118,
                                    0.180637
                                ],
                                [
                                    0.477685,
                                    0.30909,
                                    0.734591
                                ],
                                [
                                    0.646279,
                                    0.549939,
                                    0.50177
                                ],
                                [
                                    0.634237,
                                    0.586067,
                                    0.626208
                                ],
                                [
                                    0.750647,
                                    0.373317,
                                    0.92727
                                ],
                                [
                                    0.770718,
                                    0.445571,
                                    0.883114
                                ],
                                [
                                    0.983468,
                                    0.485713,
                                    0.734591
                                ],
                                [
                                    0.979454,
                                    0.509798,
                                    0.883114
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.345217,
                                    0.385359,
                                    0.50177
                                ],
                                [
                                    0.321133,
                                    0.369302,
                                    0.373317
                                ],
                                [
                                    0.317118,
                                    0.40543,
                                    0.818888
                                ],
                                [
                                    0.329161,
                                    0.35726,
                                    0.373317
                                ],
                                [
                                    0.333175,
                                    0.449586,
                                    0.734591
                                ],
                                [
                                    0.437543,
                                    0.381345,
                                    0.626208
                                ],
                                [
                                    0.401416,
                                    0.457614,
                                    0.818888
                                ],
                                [
                                    0.598109,
                                    0.373317,
                                    0.373317
                                ],
                                [
                                    0.626208,
                                    0.417472,
                                    0.264934
                                ],
                                [
                                    0.513812,
                                    0.30909,
                                    0.373317
                                ],
                                [
                                    0.493741,
                                    0.305076,
                                    0.734591
                                ],
                                [
                                    0.650293,
                                    0.545925,
                                    0.50177
                                ],
                                [
                                    0.650293,
                                    0.606138,
                                    0.626208
                                ],
                                [
                                    0.746633,
                                    0.377331,
                                    0.883114
                                ],
                                [
                                    0.766704,
                                    0.433529,
                                    0.626208
                                ],
                                [
                                    0.967412,
                                    0.489727,
                                    0.626208
                                ],
                                [
                                    0.983468,
                                    0.50177,
                                    0.734591
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.345217,
                                    0.385359,
                                    0.818888
                                ],
                                [
                                    0.329161,
                                    0.365288,
                                    0.180637
                                ],
                                [
                                    0.325147,
                                    0.413458,
                                    0.180637
                                ],
                                [
                                    0.329161,
                                    0.35726,
                                    0.264934
                                ],
                                [
                                    0.329161,
                                    0.445571,
                                    0.626208
                                ],
                                [
                                    0.445571,
                                    0.381345,
                                    0.50177
                                ],
                                [
                                    0.401416,
                                    0.469656,
                                    0.734591
                                ],
                                [
                                    0.606138,
                                    0.373317,
                                    0.180637
                                ],
                                [
                                    0.626208,
                                    0.421486,
                                    0.264934
                                ],
                                [
                                    0.517826,
                                    0.301062,
                                    0.373317
                                ],
                                [
                                    0.505784,
                                    0.305076,
                                    0.626208
                                ],
                                [
                                    0.654308,
                                    0.553954,
                                    0.373317
                                ],
                                [
                                    0.646279,
                                    0.606138,
                                    0.50177
                                ],
                                [
                                    0.746633,
                                    0.377331,
                                    0.883114
                                ],
                                [
                                    0.774732,
                                    0.433529,
                                    0.734591
                                ],
                                [
                                    0.987483,
                                    0.493741,
                                    0.818888
                                ],
                                [
                                    0.97544,
                                    0.505784,
                                    0.734591
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.341203,
                                    0.381345,
                                    0.626208
                                ],
                                [
                                    0.317118,
                                    0.369302,
                                    0.180637
                                ],
                                [
                                    0.313104,
                                    0.409444,
                                    0.373317
                                ],
                                [
                                    0.321133,
                                    0.361274,
                                    0.264934
                                ],
                                [
                                    0.329161,
                                    0.449586,
                                    0.818888
                                ],
                                [
                                    0.445571,
                                    0.389373,
                                    0.373317
                                ],
                                [
                                    0.393387,
                                    0.465642,
                                    0.734591
                                ],
                                [
                                    0.606138,
                                    0.389373,
                                    0.264934
                                ],
                                [
                                    0.610152,
                                    0.40543,
                                    0.818888
                                ],
                                [
                                    0.509798,
                                    0.305076,
                                    0.264934
                                ],
                                [
                                    0.493741,
                                    0.305076,
                                    0.734591
                                ],
                                [
                                    0.654308,
                                    0.52184,
                                    0.373317
                                ],
                                [
                                    0.642265,
                                    0.590081,
                                    0.626208
                                ],
                                [
                                    0.742619,
                                    0.373317,
                                    0.92727
                                ],
                                [
                                    0.778746,
                                    0.437543,
                                    0.734591
                                ],
                                [
                                    0.979454,
                                    0.50177,
                                    0.734591
                                ],
                                [
                                    0.97544,
                                    0.50177,
                                    0.818888
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.329161,
                                    0.389373,
                                    0.50177
                                ],
                                [
                                    0.301062,
                                    0.373317,
                                    0.264934
                                ],
                                [
                                    0.301062,
                                    0.421486,
                                    0.626208
                                ],
                                [
                                    0.30909,
                                    0.361274,
                                    0.264934
                                ],
                                [
                                    0.305076,
                                    0.4536,
                                    0.818888
                                ],
                                [
                                    0.421486,
                                    0.381345,
                                    0.626208
                                ],
                                [
                                    0.377331,
                                    0.457614,
                                    0.818888
                                ],
                                [
                                    0.602123,
                                    0.393387,
                                    0.373317
                                ],
                                [
                                    0.610152,
                                    0.401416,
                                    0.734591
                                ],
                                [
                                    0.517826,
                                    0.325147,
                                    0.264934
                                ],
                                [
                                    0.47367,
                                    0.30909,
                                    0.818888
                                ],
                                [
                                    0.630223,
                                    0.533883,
                                    0.180637
                                ],
                                [
                                    0.634237,
                                    0.582053,
                                    0.373317
                                ],
                                [
                                    0.742619,
                                    0.373317,
                                    0.92727
                                ],
                                [
                                    0.770718,
                                    0.433529,
                                    0.734591
                                ],
                                [
                                    0.979454,
                                    0.493741,
                                    0.734591
                                ],
                                [
                                    0.97544,
                                    0.513812,
                                    0.818888
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.297048,
                                    0.397402,
                                    0.50177
                                ],
                                [
                                    0.268948,
                                    0.377331,
                                    0.264934
                                ],
                                [
                                    0.272963,
                                    0.417472,
                                    0.50177
                                ],
                                [
                                    0.293033,
                                    0.365288,
                                    0.264934
                                ],
                                [
                                    0.285005,
                                    0.449586,
                                    0.626208
                                ],
                                [
                                    0.401416,
                                    0.385359,
                                    0.626208
                                ],
                                [
                                    0.35726,
                                    0.4536,
                                    0.883114
                                ],
                                [
                                    0.574024,
                                    0.393387,
                                    0.373317
                                ],
                                [
                                    0.565996,
                                    0.421486,
                                    0.264934
                                ],
                                [
                                    0.493741,
                                    0.313104,
                                    0.264934
                                ],
                                [
                                    0.4536,
                                    0.313104,
                                    0.734591
                                ],
                                [
                                    0.622194,
                                    0.517826,
                                    0.626208
                                ],
                                [
                                    0.614166,
                                    0.565996,
                                    0.50177
                                ],
                                [
                                    0.738605,
                                    0.381345,
                                    0.883114
                                ],
                                [
                                    0.778746,
                                    0.441557,
                                    0.626208
                                ],
                                [
                                    0.983468,
                                    0.493741,
                                    0.818888
                                ],
                                [
                                    0.979454,
                                    0.517826,
                                    0.818888
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.252892,
                                    0.401416,
                                    0.626208
                                ],
                                [
                                    0.232821,
                                    0.381345,
                                    0.818888
                                ],
                                [
                                    0.232821,
                                    0.429515,
                                    0.734591
                                ],
                                [
                                    0.240849,
                                    0.369302,
                                    0.180637
                                ],
                                [
                                    0.252892,
                                    0.4536,
                                    0.734591
                                ],
                                [
                                    0.369302,
                                    0.377331,
                                    0.373317
                                ],
                                [
                                    0.321133,
                                    0.461628,
                                    0.734591
                                ],
                                [
                                    0.525855,
                                    0.385359,
                                    0.264934
                                ],
                                [
                                    0.513812,
                                    0.401416,
                                    0.818888
                                ],
                                [
                                    0.433529,
                                    0.313104,
                                    0.50177
                                ],
                                [
                                    0.409444,
                                    0.305076,
                                    0.734591
                                ],
                                [
                                    0.594095,
                                    0.529869,
                                    0.626208
                                ],
                                [
                                    0.578039,
                                    0.606138,
                                    0.734591
                                ],
                                [
                                    0.738605,
                                    0.389373,
                                    0.883114
                                ],
                                [
                                    0.774732,
                                    0.4536,
                                    0.734591
                                ],
                                [
                                    0.979454,
                                    0.481699,
                                    0.734591
                                ],
                                [
                                    0.983468,
                                    0.505784,
                                    0.734591
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.220779,
                                    0.401416,
                                    0.734591
                                ],
                                [
                                    0.19268,
                                    0.389373,
                                    0.734591
                                ],
                                [
                                    0.19268,
                                    0.433529,
                                    0.734591
                                ],
                                [
                                    0.196694,
                                    0.365288,
                                    0.50177
                                ],
                                [
                                    0.216764,
                                    0.457614,
                                    0.626208
                                ],
                                [
                                    0.333175,
                                    0.381345,
                                    0.734591
                                ],
                                [
                                    0.285005,
                                    0.481699,
                                    0.734591
                                ],
                                [
                                    0.485713,
                                    0.373317,
                                    0.734591
                                ],
                                [
                                    0.493741,
                                    0.409444,
                                    0.626208
                                ],
                                [
                                    0.437543,
                                    0.333175,
                                    0.180637
                                ],
                                [
                                    0.365288,
                                    0.30909,
                                    0.626208
                                ],
                                [
                                    0.582053,
                                    0.517826,
                                    0.626208
                                ],
                                [
                                    0.557968,
                                    0.594095,
                                    0.818888
                                ],
                                [
                                    0.742619,
                                    0.397402,
                                    0.373317
                                ],
                                [
                                    0.770718,
                                    0.457614,
                                    0.818888
                                ],
                                [
                                    0.971426,
                                    0.489727,
                                    0.818888
                                ],
                                [
                                    0.979454,
                                    0.517826,
                                    0.734591
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.188665,
                                    0.409444,
                                    0.734591
                                ],
                                [
                                    0.152538,
                                    0.397402,
                                    0.734591
                                ],
                                [
                                    0.156552,
                                    0.437543,
                                    0.626208
                                ],
                                [
                                    0.16458,
                                    0.377331,
                                    0.373317
                                ],
                                [
                                    0.176623,
                                    0.469656,
                                    0.626208
                                ],
                                [
                                    0.280991,
                                    0.377331,
                                    0.626208
                                ],
                                [
                                    0.252892,
                                    0.481699,
                                    0.883114
                                ],
                                [
                                    0.457614,
                                    0.365288,
                                    0.734591
                                ],
                                [
                                    0.449586,
                                    0.409444,
                                    0.626208
                                ],
                                [
                                    0.353246,
                                    0.297048,
                                    0.50177
                                ],
                                [
                                    0.317118,
                                    0.317118,
                                    0.818888
                                ],
                                [
                                    0.561982,
                                    0.505784,
                                    0.734591
                                ],
                                [
                                    0.545925,
                                    0.578039,
                                    0.734591
                                ],
                                [
                                    0.734591,
                                    0.401416,
                                    0.734591
                                ],
                                [
                                    0.754661,
                                    0.47367,
                                    0.883114
                                ],
                                [
                                    0.963398,
                                    0.485713,
                                    0.373317
                                ],
                                [
                                    0.979454,
                                    0.517826,
                                    0.734591
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.14451,
                                    0.425501,
                                    0.626208
                                ],
                                [
                                    0.124439,
                                    0.40543,
                                    0.734591
                                ],
                                [
                                    0.132467,
                                    0.4536,
                                    0.734591
                                ],
                                [
                                    0.136481,
                                    0.381345,
                                    0.50177
                                ],
                                [
                                    0.160566,
                                    0.47367,
                                    0.626208
                                ],
                                [
                                    0.264934,
                                    0.373317,
                                    0.818888
                                ],
                                [
                                    0.228807,
                                    0.489727,
                                    0.883114
                                ],
                                [
                                    0.425501,
                                    0.35726,
                                    0.50177
                                ],
                                [
                                    0.409444,
                                    0.409444,
                                    0.373317
                                ],
                                [
                                    0.341203,
                                    0.321133,
                                    0.264934
                                ],
                                [
                                    0.293033,
                                    0.341203,
                                    0.626208
                                ],
                                [
                                    0.545925,
                                    0.497755,
                                    0.626208
                                ],
                                [
                                    0.52184,
                                    0.574024,
                                    0.818888
                                ],
                                [
                                    0.722548,
                                    0.413458,
                                    0.734591
                                ],
                                [
                                    0.750647,
                                    0.481699,
                                    0.883114
                                ],
                                [
                                    0.97544,
                                    0.493741,
                                    0.50177
                                ],
                                [
                                    0.979454,
                                    0.52184,
                                    0.50177
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.108382,
                                    0.433529,
                                    0.734591
                                ],
                                [
                                    0.084297,
                                    0.413458,
                                    0.734591
                                ],
                                [
                                    0.084297,
                                    0.461628,
                                    0.734591
                                ],
                                [
                                    0.092326,
                                    0.393387,
                                    0.373317
                                ],
                                [
                                    0.112396,
                                    0.485713,
                                    0.626208
                                ],
                                [
                                    0.224793,
                                    0.385359,
                                    0.626208
                                ],
                                [
                                    0.19268,
                                    0.509798,
                                    0.818888
                                ],
                                [
                                    0.381345,
                                    0.35726,
                                    0.92727
                                ],
                                [
                                    0.373317,
                                    0.429515,
                                    0.264934
                                ],
                                [
                                    0.240849,
                                    0.313104,
                                    0.626208
                                ],
                                [
                                    0.393387,
                                    0.493741,
                                    0.072255
                                ],
                                [
                                    0.525855,
                                    0.47367,
                                    0.734591
                                ],
                                [
                                    0.50177,
                                    0.537897,
                                    0.734591
                                ],
                                [
                                    0.722548,
                                    0.433529,
                                    0.883114
                                ],
                                [
                                    0.746633,
                                    0.493741,
                                    0.92727
                                ],
                                [
                                    0.971426,
                                    0.465642,
                                    0.883114
                                ],
                                [
                                    0.97544,
                                    0.509798,
                                    0.734591
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.088311,
                                    0.433529,
                                    0.626208
                                ],
                                [
                                    0.068241,
                                    0.421486,
                                    0.734591
                                ],
                                [
                                    0.076269,
                                    0.469656,
                                    0.626208
                                ],
                                [
                                    0.084297,
                                    0.409444,
                                    0.373317
                                ],
                                [
                                    0.092326,
                                    0.493741,
                                    0.50177
                                ],
                                [
                                    0.19268,
                                    0.385359,
                                    0.626208
                                ],
                                [
                                    0.160566,
                                    0.509798,
                                    0.734591
                                ],
                                [
                                    0.377331,
                                    0.365288,
                                    0.818888
                                ],
                                [
                                    0.337189,
                                    0.417472,
                                    0.626208
                                ],
                                [
                                    0.232821,
                                    0.321133,
                                    0.626208
                                ],
                                [
                                    0.208736,
                                    0.329161,
                                    0.734591
                                ],
                                [
                                    0.52184,
                                    0.481699,
                                    0.734591
                                ],
                                [
                                    0.50177,
                                    0.533883,
                                    0.734591
                                ],
                                [
                                    0.722548,
                                    0.441557,
                                    0.883114
                                ],
                                [
                                    0.742619,
                                    0.497755,
                                    0.734591
                                ],
                                [
                                    0.97544,
                                    0.47367,
                                    0.92727
                                ],
                                [
                                    0.983468,
                                    0.525855,
                                    0.734591
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.088311,
                                    0.441557,
                                    0.734591
                                ],
                                [
                                    0.052184,
                                    0.425501,
                                    0.626208
                                ],
                                [
                                    0.060212,
                                    0.47367,
                                    0.734591
                                ],
                                [
                                    0.068241,
                                    0.40543,
                                    0.264934
                                ],
                                [
                                    0.076269,
                                    0.50177,
                                    0.734591
                                ],
                                [
                                    0.188665,
                                    0.401416,
                                    0.626208
                                ],
                                [
                                    0.156552,
                                    0.525855,
                                    0.818888
                                ],
                                [
                                    0.345217,
                                    0.349232,
                                    0.883114
                                ],
                                [
                                    0.337189,
                                    0.429515,
                                    0.883114
                                ],
                                [
                                    0.220779,
                                    0.325147,
                                    0.50177
                                ],
                                [
                                    0.200708,
                                    0.341203,
                                    0.626208
                                ],
                                [
                                    0.525855,
                                    0.47367,
                                    0.626208
                                ],
                                [
                                    0.50177,
                                    0.513812,
                                    0.626208
                                ],
                                [
                                    0.726562,
                                    0.449586,
                                    0.883114
                                ],
                                [
                                    0.730577,
                                    0.493741,
                                    0.818888
                                ],
                                [
                                    0.97544,
                                    0.489727,
                                    0.264934
                                ],
                                [
                                    0.979454,
                                    0.533883,
                                    0.883114
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.064227,
                                    0.445571,
                                    0.626208
                                ],
                                [
                                    0.04817,
                                    0.437543,
                                    0.50177
                                ],
                                [
                                    0.04817,
                                    0.469656,
                                    0.626208
                                ],
                                [
                                    0.068241,
                                    0.413458,
                                    0.626208
                                ],
                                [
                                    0.080283,
                                    0.509798,
                                    0.50177
                                ],
                                [
                                    0.19268,
                                    0.40543,
                                    0.626208
                                ],
                                [
                                    0.156552,
                                    0.529869,
                                    0.734591
                                ],
                                [
                                    0.333175,
                                    0.353246,
                                    0.818888
                                ],
                                [
                                    0.317118,
                                    0.429515,
                                    0.734591
                                ],
                                [
                                    0.200708,
                                    0.325147,
                                    0.373317
                                ],
                                [
                                    0.188665,
                                    0.341203,
                                    0.626208
                                ],
                                [
                                    0.517826,
                                    0.47367,
                                    0.626208
                                ],
                                [
                                    0.505784,
                                    0.525855,
                                    0.734591
                                ],
                                [
                                    0.722548,
                                    0.457614,
                                    0.818888
                                ],
                                [
                                    0.722548,
                                    0.493741,
                                    0.264934
                                ],
                                [
                                    0.971426,
                                    0.477685,
                                    0.883114
                                ],
                                [
                                    0.979454,
                                    0.525855,
                                    0.818888
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.068241,
                                    0.449586,
                                    0.626208
                                ],
                                [
                                    0.04817,
                                    0.437543,
                                    0.626208
                                ],
                                [
                                    0.056198,
                                    0.481699,
                                    0.50177
                                ],
                                [
                                    0.068241,
                                    0.425501,
                                    0.373317
                                ],
                                [
                                    0.076269,
                                    0.525855,
                                    0.734591
                                ],
                                [
                                    0.184651,
                                    0.40543,
                                    0.734591
                                ],
                                [
                                    0.14451,
                                    0.529869,
                                    0.818888
                                ],
                                [
                                    0.333175,
                                    0.353246,
                                    0.883114
                                ],
                                [
                                    0.305076,
                                    0.437543,
                                    0.883114
                                ],
                                [
                                    0.220779,
                                    0.329161,
                                    0.116411
                                ],
                                [
                                    0.176623,
                                    0.345217,
                                    0.734591
                                ],
                                [
                                    0.505784,
                                    0.477685,
                                    0.734591
                                ],
                                [
                                    0.489727,
                                    0.513812,
                                    0.734591
                                ],
                                [
                                    0.730577,
                                    0.465642,
                                    0.626208
                                ],
                                [
                                    0.730577,
                                    0.505784,
                                    0.883114
                                ],
                                [
                                    0.971426,
                                    0.489727,
                                    0.373317
                                ],
                                [
                                    0.991497,
                                    0.529869,
                                    0.264934
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.068241,
                                    0.4536,
                                    0.50177
                                ],
                                [
                                    0.04817,
                                    0.441557,
                                    0.626208
                                ],
                                [
                                    0.04817,
                                    0.481699,
                                    0.50177
                                ],
                                [
                                    0.064227,
                                    0.425501,
                                    0.626208
                                ],
                                [
                                    0.076269,
                                    0.525855,
                                    0.626208
                                ],
                                [
                                    0.184651,
                                    0.40543,
                                    0.818888
                                ],
                                [
                                    0.148524,
                                    0.533883,
                                    0.734591
                                ],
                                [
                                    0.333175,
                                    0.35726,
                                    0.734591
                                ],
                                [
                                    0.30909,
                                    0.433529,
                                    0.734591
                                ],
                                [
                                    0.232821,
                                    0.345217,
                                    0.180637
                                ],
                                [
                                    0.172609,
                                    0.341203,
                                    0.734591
                                ],
                                [
                                    0.513812,
                                    0.47367,
                                    0.50177
                                ],
                                [
                                    0.489727,
                                    0.513812,
                                    0.734591
                                ],
                                [
                                    0.730577,
                                    0.461628,
                                    0.818888
                                ],
                                [
                                    0.730577,
                                    0.50177,
                                    0.734591
                                ],
                                [
                                    0.967412,
                                    0.493741,
                                    0.50177
                                ],
                                [
                                    0.987483,
                                    0.52184,
                                    0.373317
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.064227,
                                    0.4536,
                                    0.626208
                                ],
                                [
                                    0.04817,
                                    0.441557,
                                    0.50177
                                ],
                                [
                                    0.04817,
                                    0.481699,
                                    0.50177
                                ],
                                [
                                    0.068241,
                                    0.425501,
                                    0.50177
                                ],
                                [
                                    0.076269,
                                    0.52184,
                                    0.734591
                                ],
                                [
                                    0.180637,
                                    0.409444,
                                    0.734591
                                ],
                                [
                                    0.14451,
                                    0.541911,
                                    0.883114
                                ],
                                [
                                    0.337189,
                                    0.353246,
                                    0.883114
                                ],
                                [
                                    0.30909,
                                    0.429515,
                                    0.818888
                                ],
                                [
                                    0.196694,
                                    0.341203,
                                    0.626208
                                ],
                                [
                                    0.188665,
                                    0.35726,
                                    0.626208
                                ],
                                [
                                    0.513812,
                                    0.461628,
                                    0.734591
                                ],
                                [
                                    0.505784,
                                    0.509798,
                                    0.734591
                                ],
                                [
                                    0.738605,
                                    0.4536,
                                    0.818888
                                ],
                                [
                                    0.734591,
                                    0.505784,
                                    0.818888
                                ],
                                [
                                    0.963398,
                                    0.47367,
                                    0.734591
                                ],
                                [
                                    0.983468,
                                    0.529869,
                                    0.818888
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.064227,
                                    0.4536,
                                    0.626208
                                ],
                                [
                                    0.04817,
                                    0.437543,
                                    0.734591
                                ],
                                [
                                    0.052184,
                                    0.481699,
                                    0.734591
                                ],
                                [
                                    0.060212,
                                    0.425501,
                                    0.50177
                                ],
                                [
                                    0.084297,
                                    0.52184,
                                    0.734591
                                ],
                                [
                                    0.184651,
                                    0.409444,
                                    0.818888
                                ],
                                [
                                    0.148524,
                                    0.541911,
                                    0.883114
                                ],
                                [
                                    0.333175,
                                    0.35726,
                                    0.180637
                                ],
                                [
                                    0.305076,
                                    0.437543,
                                    0.818888
                                ],
                                [
                                    0.19268,
                                    0.337189,
                                    0.50177
                                ],
                                [
                                    0.216764,
                                    0.381345,
                                    0.180637
                                ],
                                [
                                    0.52184,
                                    0.469656,
                                    0.818888
                                ],
                                [
                                    0.497755,
                                    0.517826,
                                    0.734591
                                ],
                                [
                                    0.730577,
                                    0.4536,
                                    0.818888
                                ],
                                [
                                    0.730577,
                                    0.493741,
                                    0.734591
                                ],
                                [
                                    0.971426,
                                    0.477685,
                                    0.818888
                                ],
                                [
                                    0.983468,
                                    0.529869,
                                    0.734591
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.068241,
                                    0.449586,
                                    0.626208
                                ],
                                [
                                    0.04817,
                                    0.441557,
                                    0.50177
                                ],
                                [
                                    0.04817,
                                    0.481699,
                                    0.626208
                                ],
                                [
                                    0.068241,
                                    0.421486,
                                    0.373317
                                ],
                                [
                                    0.072255,
                                    0.517826,
                                    0.818888
                                ],
                                [
                                    0.180637,
                                    0.401416,
                                    0.734591
                                ],
                                [
                                    0.152538,
                                    0.529869,
                                    0.818888
                                ],
                                [
                                    0.337189,
                                    0.35726,
                                    0.734591
                                ],
                                [
                                    0.317118,
                                    0.437543,
                                    0.626208
                                ],
                                [
                                    0.236835,
                                    0.333175,
                                    0.116411
                                ],
                                [
                                    0.19268,
                                    0.353246,
                                    0.626208
                                ],
                                [
                                    0.517826,
                                    0.465642,
                                    0.734591
                                ],
                                [
                                    0.50177,
                                    0.52184,
                                    0.734591
                                ],
                                [
                                    0.726562,
                                    0.4536,
                                    0.734591
                                ],
                                [
                                    0.730577,
                                    0.493741,
                                    0.626208
                                ],
                                [
                                    0.971426,
                                    0.481699,
                                    0.818888
                                ],
                                [
                                    0.983468,
                                    0.525855,
                                    0.818888
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.084297,
                                    0.445571,
                                    0.626208
                                ],
                                [
                                    0.052184,
                                    0.433529,
                                    0.50177
                                ],
                                [
                                    0.064227,
                                    0.477685,
                                    0.373317
                                ],
                                [
                                    0.080283,
                                    0.421486,
                                    0.264934
                                ],
                                [
                                    0.092326,
                                    0.509798,
                                    0.50177
                                ],
                                [
                                    0.196694,
                                    0.409444,
                                    0.734591
                                ],
                                [
                                    0.156552,
                                    0.529869,
                                    0.883114
                                ],
                                [
                                    0.345217,
                                    0.353246,
                                    0.883114
                                ],
                                [
                                    0.329161,
                                    0.433529,
                                    0.50177
                                ],
                                [
                                    0.216764,
                                    0.333175,
                                    0.50177
                                ],
                                [
                                    0.208736,
                                    0.337189,
                                    0.626208
                                ],
                                [
                                    0.52184,
                                    0.477685,
                                    0.734591
                                ],
                                [
                                    0.505784,
                                    0.525855,
                                    0.734591
                                ],
                                [
                                    0.722548,
                                    0.433529,
                                    0.734591
                                ],
                                [
                                    0.726562,
                                    0.481699,
                                    0.264934
                                ],
                                [
                                    0.967412,
                                    0.481699,
                                    0.626208
                                ],
                                [
                                    0.979454,
                                    0.52184,
                                    0.626208
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.09634,
                                    0.433529,
                                    0.734591
                                ],
                                [
                                    0.076269,
                                    0.425501,
                                    0.626208
                                ],
                                [
                                    0.084297,
                                    0.469656,
                                    0.626208
                                ],
                                [
                                    0.088311,
                                    0.401416,
                                    0.264934
                                ],
                                [
                                    0.112396,
                                    0.50177,
                                    0.50177
                                ],
                                [
                                    0.208736,
                                    0.369302,
                                    0.373317
                                ],
                                [
                                    0.184651,
                                    0.513812,
                                    0.734591
                                ],
                                [
                                    0.373317,
                                    0.349232,
                                    0.734591
                                ],
                                [
                                    0.353246,
                                    0.429515,
                                    0.818888
                                ],
                                [
                                    0.236835,
                                    0.313104,
                                    0.734591
                                ],
                                [
                                    0.244864,
                                    0.329161,
                                    0.626208
                                ],
                                [
                                    0.529869,
                                    0.481699,
                                    0.734591
                                ],
                                [
                                    0.505784,
                                    0.529869,
                                    0.734591
                                ],
                                [
                                    0.730577,
                                    0.421486,
                                    0.626208
                                ],
                                [
                                    0.750647,
                                    0.477685,
                                    0.818888
                                ],
                                [
                                    0.97544,
                                    0.50177,
                                    0.264934
                                ],
                                [
                                    0.983468,
                                    0.52184,
                                    0.734591
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.136481,
                                    0.429515,
                                    0.734591
                                ],
                                [
                                    0.112396,
                                    0.413458,
                                    0.50177
                                ],
                                [
                                    0.108382,
                                    0.4536,
                                    0.626208
                                ],
                                [
                                    0.124439,
                                    0.401416,
                                    0.264934
                                ],
                                [
                                    0.132467,
                                    0.485713,
                                    0.50177
                                ],
                                [
                                    0.240849,
                                    0.377331,
                                    0.50177
                                ],
                                [
                                    0.216764,
                                    0.493741,
                                    0.818888
                                ],
                                [
                                    0.401416,
                                    0.353246,
                                    0.883114
                                ],
                                [
                                    0.401416,
                                    0.413458,
                                    0.734591
                                ],
                                [
                                    0.276977,
                                    0.317118,
                                    0.734591
                                ],
                                [
                                    0.268948,
                                    0.337189,
                                    0.626208
                                ],
                                [
                                    0.525855,
                                    0.47367,
                                    0.818888
                                ],
                                [
                                    0.525855,
                                    0.561982,
                                    0.734591
                                ],
                                [
                                    0.730577,
                                    0.413458,
                                    0.50177
                                ],
                                [
                                    0.754661,
                                    0.461628,
                                    0.92727
                                ],
                                [
                                    0.971426,
                                    0.485713,
                                    0.626208
                                ],
                                [
                                    0.97544,
                                    0.52184,
                                    0.626208
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.16458,
                                    0.421486,
                                    0.734591
                                ],
                                [
                                    0.136481,
                                    0.401416,
                                    0.50177
                                ],
                                [
                                    0.14451,
                                    0.449586,
                                    0.626208
                                ],
                                [
                                    0.152538,
                                    0.385359,
                                    0.50177
                                ],
                                [
                                    0.160566,
                                    0.47367,
                                    0.373317
                                ],
                                [
                                    0.264934,
                                    0.385359,
                                    0.50177
                                ],
                                [
                                    0.232821,
                                    0.481699,
                                    0.818888
                                ],
                                [
                                    0.429515,
                                    0.365288,
                                    0.626208
                                ],
                                [
                                    0.425501,
                                    0.409444,
                                    0.626208
                                ],
                                [
                                    0.337189,
                                    0.317118,
                                    0.264934
                                ],
                                [
                                    0.301062,
                                    0.317118,
                                    0.734591
                                ],
                                [
                                    0.541911,
                                    0.485713,
                                    0.818888
                                ],
                                [
                                    0.537897,
                                    0.561982,
                                    0.626208
                                ],
                                [
                                    0.730577,
                                    0.40543,
                                    0.818888
                                ],
                                [
                                    0.76269,
                                    0.47367,
                                    0.883114
                                ],
                                [
                                    0.955369,
                                    0.477685,
                                    0.264934
                                ],
                                [
                                    0.983468,
                                    0.52184,
                                    0.734591
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.200708,
                                    0.40543,
                                    0.734591
                                ],
                                [
                                    0.176623,
                                    0.389373,
                                    0.734591
                                ],
                                [
                                    0.176623,
                                    0.433529,
                                    0.734591
                                ],
                                [
                                    0.188665,
                                    0.385359,
                                    0.373317
                                ],
                                [
                                    0.19268,
                                    0.461628,
                                    0.734591
                                ],
                                [
                                    0.297048,
                                    0.389373,
                                    0.734591
                                ],
                                [
                                    0.256906,
                                    0.481699,
                                    0.818888
                                ],
                                [
                                    0.465642,
                                    0.385359,
                                    0.626208
                                ],
                                [
                                    0.465642,
                                    0.413458,
                                    0.734591
                                ],
                                [
                                    0.353246,
                                    0.305076,
                                    0.626208
                                ],
                                [
                                    0.337189,
                                    0.317118,
                                    0.626208
                                ],
                                [
                                    0.57001,
                                    0.509798,
                                    0.734591
                                ],
                                [
                                    0.541911,
                                    0.574024,
                                    0.818888
                                ],
                                [
                                    0.734591,
                                    0.393387,
                                    0.818888
                                ],
                                [
                                    0.76269,
                                    0.465642,
                                    0.818888
                                ],
                                [
                                    0.967412,
                                    0.481699,
                                    0.626208
                                ],
                                [
                                    0.983468,
                                    0.517826,
                                    0.180637
                                ]
                            ]
                        ]
                    ],
                    [
                        [
                            [
                                [
                                    0.236835,
                                    0.397402,
                                    0.734591
                                ],
                                [
                                    0.204722,
                                    0.381345,
                                    0.734591
                                ],
                                [
                                    0.21275,
                                    0.421486,
                                    0.734591
                                ],
                                [
                                    0.208736,
                                    0.369302,
                                    0.50177
                                ],
                                [
                                    0.220779,
                                    0.461628,
                                    0.734591
                                ],
                                [
                                    0.341203,
                                    0.373317,
                                    0.734591
                                ],
                                [
                                    0.293033,
                                    0.47367,
                                    0.818888
                                ],
                                [
                                    0.50177,
                                    0.389373,
                                    0.734591
                                ],
                                [
                                    0.497755,
                                    0.401416,
                                    0.883114
                                ],
                                [
                                    0.429515,
                                    0.321133,
                                    0.264934
                                ],
                                [
                                    0.381345,
                                    0.30909,
                                    0.50177
                                ],
                                [
                                    0.578039,
                                    0.517826,
                                    0.734591
                                ],
                                [
                                    0.553954,
                                    0.594095,
                                    0.818888
                                ],
                                [
                                    0.734591,
                                    0.397402,
                                    0.50177
                                ],
                                [
                                    0.766704,
                                    0.4536,
                                    0.818888
                                ],
                                [
                                    0.979454,
                                    0.489727,
                                    0.626208
                                ],
                                [
                                    0.979454,
                                    0.513812,
                                    0.626208
                                ]
                            ]
                        ]
                    ]
                ],
                "task_id": "excounter_test|test1|squats|9aa90719486c470eb02a365b90135eb4"
        }"""
            counter += 1


if __name__ == "__main__":
    loop = asyncio.new_event_loop()
    asyncio.set_event_loop(loop)

    producer = producer_application.ProducerApplication(
        bootstrap_servers=settings.config["KafkaConsumer"]["servers"],
    )

    logger.info("Starting consumer")
    loop.create_task(producer.produce(topics=[settings.config["KafkaConsumer"]["topic"]], messages=message_factory()))
    loop.run_forever()
